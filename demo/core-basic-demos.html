<dom-module id="core-basic-demos">
  <template>
    <style include="vaadin-component-demo-shared-styles">
      :host {
        display: block;
      }
    </style>

    <h3>The <code>Router</code> class</h3>
    <p>The <code>Router</code> class can be imported from the <code>@vaadin/router</code>
      module in the browsers that support ES modules:
    </p>
    <pre><code>&lt;script type="module"&gt;
  import {Router} from '@vaadin/router';
&lt;/script&gt;</code></pre>
    <p>For the browsers that do not support ES modules, the  <code>Router</code>
      class is exposed as a member of the <code>Vaadin</code> namespace after
      the vaadin-router UMD bundle is loaded:
    </p>
    <pre><code>&lt;script src="bower_components/vaadin-router/vaadin-router.min.js"&gt;&lt;/script&gt;
&lt;script&gt;
  var Router = Vaadin.Router;
&lt;/script&gt;</code></pre>

    <h3>Basic</h3>
    <p>Vaadin.Router needs an outlet (a DOM Node to render into), and a routes
      config. Once created, it automatically subscribes to <code>popstate</code> events on
      the <code>window</code> and updates the rendered component every time
      either the location or the routes config changes.</p>
    <p>The routes config maps paths to Web Components. Vaadin.Router goes
      through the routes until it finds the first match, creates an instance
      of the route component, and inserts it into the router outlet (replacing
      any pre-existing outlet content).</p>
    <p>The route component can be any Web Component regardless of how it is
      built: vanilla JavaScript, Polymer, Stencil, SkateJS, Angular, Vue, etc</p>
    <vaadin-demo-snippet id="core-basic-demos-1" iframe-src="iframe.html">
      <template preserve-content>
        <div id="outlet"></div>
        <script type="module">
          // import {Router} from '@vaadin/router';
          const {Router} = window.Vaadin;

          const router = new Router(document.getElementById('outlet'));
          router.setRoutes([
            {path: '/', component: 'x-home-view'},
            {path: '/users', component: 'x-user-list'},
          ]);
        </script>
      </template>
    </vaadin-demo-snippet>

    <h3>Child Routes</h3>
    <p>Each route can have child routes:</p>
    <vaadin-demo-snippet id="core-basic-demos-2" iframe-src="iframe.html">
      <template preserve-content>
        <div id="outlet"></div>
        <script type="module">
          // import {Router} from '@vaadin/router';
          const {Router} = window.Vaadin;

          const router = new Router(document.getElementById('outlet'));
          router.setRoutes([
            {path: '/', component: 'x-home-view'},
            {path: '/users',
              children: [
                {path: '/', component: 'x-user-list'},
                {path: '/:user', component: 'x-user-profile'}
              ]
            },
          ]);
        </script>
      </template>
    </vaadin-demo-snippet>

    <h3>Route Parameters</h3>
    <p>Route parameters are defined using <a href="https://github.com/pillarjs/path-to-regexp#parameters"
      target="_blank">express-like syntax</a>. All features are supported:
      <ul>
        <li>named parameters: <code>/profile/:user</code></li>
        <li>optional parameters: <code>/:size/:color?</code></li>
        <li>zero-or-more segments: <code>/kb/:path*</code></li>
        <li>one-or-more segments: <code>/kb/:path+</code></li>
        <li>custom parameter patterns: <code>/image-:size(\d+)px</code></li>
        <li>unnamed parameters: <code>/(user[s]?)/:id</code></li>
      </ul>
    </p>
    <p>Named parameters are bound to route component properties. Unnamed
      parameters are accessible by index through the <code>route.params</code>
      array. (the <code>route</code> property is set on the route component by
      the router).</p>
    <vaadin-demo-snippet id="core-basic-examples-3" iframe-src="iframe.html">
      <template preserve-content>
        <div id="outlet"></div>
        <script type="module">
          // import {Router} from '@vaadin/router';
          const {Router} = window.Vaadin;

          const router = new Router(document.getElementById('outlet'));
          router.setRoutes([
            {path: '/', component: 'x-home-view'},
            {path: '/profile/:user', component: 'x-user-profile'},
            {path: '/image/:size/:color?', component: 'x-image-view'},
            {path: '/image-:size(\\d+)px', component: 'x-image-view'},
            {path: '/kb/:path*', component: 'x-knowledge-base'},
            {path: '/(user[s]?)/:id', component: 'x-profile-view'},
          ]);
        </script>

        <dom-module id="x-profile-view">
          <template preserve-content>
            User ID: [[id]]<br/>
            <code>/user</code> or <code>/users</code>: [[route.params.0]]
          </template>
          <script>
            class XProfileView extends Polymer.Element {
              static get is() {
                return 'x-profile-view';
              }

              static get properties() {
                return {
                  id: String,
                  route: Object
                };
              }
            }
            window.customElements.define(XProfileView.is, XProfileView);
          </script>
        </dom-module>

        <dom-module id="x-image-view">
          <template preserve-content>
            <div style$="height: [[size]]px; width: [[size]]px; background: [[color]];"></div>
          </template>
          <script>
            class XImageView extends Polymer.Element {
              static get is() {
                return 'x-image-view';
              }

              static get properties() {
                return {
                  size: String,
                  color: {
                    type: String,
                    value: 'hotpink'
                  }
                };
              }
            }
            window.customElements.define(XImageView.is, XImageView);
          </script>
        </dom-module>

        <dom-module id="x-knowledge-base">
          <template preserve-content>
            Knowledge base path: '[[path]]'
          </template>
          <script>
            class XKnowledgeBase extends Polymer.Element {
              static get is() {
                return 'x-knowledge-base';
              }

              static get properties() {
                return {
                  path: Array
                };
              }
            }
            window.customElements.define(XKnowledgeBase.is, XKnowledgeBase);
          </script>
        </dom-module>
      </template>
    </vaadin-demo-snippet>
  </template>
  <script>
    class CoreBasicDemos extends DemoReadyEventEmitter(ElementDemo(Polymer.Element)) {
      static get is() {
        return 'core-basic-demos';
      }
    }
    customElements.define(CoreBasicDemos.is, CoreBasicDemos);
  </script>
</dom-module>
